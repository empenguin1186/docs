
# ソフトウェアアーキテクチャの責務

## ソフトウェアアーキテクチャの構成要素
- システムの構造
  - アーキテクチャスタイルのこと(マイクロサービス、レイヤード etc...)
- アーキテクチャ特性
  - システムの機能とは直接は関係しないが、システムの成功基準を定義する上で考慮しなければならないこと。非機能要件みたいなもの？(可用性、スケーラビリティ、パフォーマンス etc...)
- アーキテクチャ決定
  - どのようにシステムを構築するのかをコードレベルで考えること(レイヤードアーキテクチャで構築する場合はビジネス層とサービス層のみデータベースにアクセスでき、プレゼンテーション層はアクセスを行わないようにする)。そして決定した方針をメンバーに順守させること。
- 設計指針
  - 開発におけるガイドラインを提供すること。基本的に決定した方針を順守させるアーキテクチャ設計とは異なり、より望ましいアプローチを提供するといったような緩さのもの(REST or Grpc)。

## アーキテクチャに期待すること
- アーキテクチャ決定を下す
  - 特定の技術を使用することを指示するのではく、構築するシステムに対して望ましい特性を持つ技術を使用することを指示する(React を使用するように指示するのではなく、リアクティブベースのフレームワークを使用することを指示する)。
- アーキテクチャを継続的に分析する
  - すでにリリースされているシステムに対して、適用されているアーキテクチャが最適かどうかを継続的に分析することが求められる。
- 最新のトレンドを把握し続ける
  - 自明なので省略
- 決定の順守を徹底する
  - レイヤードアーキテクチャを採用しているのにもかかわらず、データベースへのアクセスをプレゼンテーション層に実装することのないようにといったような、指針の順守を徹底させる
- 様々なものに触れ、経験している
  - アーキテクトにおける引き出しを増やしておく。この点に関しては技術的な深さよりも幅を優先するように知識を習得するのが望ましい。
- 事業ドメインの知識を持っている
  - 対象となるサービスの知識を理解していないと最適なアーキテクチャを検討することは難しい。金融システムのアーキテクチャを検討するにあたり、金融用語を知っていないとどのようにシステムを構築すればいいのか見当もつかないし、ステークホルダーとのこのコミュニケーションもうまくいかない可能性がある。
- 対人スキルを持ち合わせている
  - チームへの指導や設計指針の伝達など、アーキテクチャには対人スキルを求められる場面が多い。
- 政治を理解し、舵取りをする
  - 考案したアーキテクチャで開発を進めるためにプロジェクトマネージャ、ビジネスサイド、または開発者を納得させねばならない。

## アーキテクチャと交わるもの

### エンジニアリングプラクティス
- 問題を解決しようとしている領域に適したシステムアーキテクチャがあるのと同様に、特定のシステムアーキテクチャに適したエンジニアリングプラクティス(開発プロセスのことを指す。具体的には CI/CD の導入など)も存在する。したがって開発者は採用するアーキテクチャに適したエンジニアリングプラクティスを実施するのが望ましい。例えばマイクロサービスアーキテクチャはここのシステムの規模が小さいので開発のイテレーションを重ねていくことになるためCI/CDの導入は必須である。
- また運用していく上でシステムのアーキテクチャは開発を重ねていくたびに変化していくことになるので、定期的にシステムのアーキテクチャ特性が十分かどうかを確認する必要がある。確認するためにはアーキテクチャ適応度関数という考え方を取り入れることが望ましい。アーキテクチャ適応度関数とはそのシステムのアーキテクチャ特性を定量化したものである。例えば、とあるシステムでページの読み込み時間をなるべく短くすることに関心がある場合、その読み込み時間を計測するようなテストなりメトリクスを用意して常にモニタリングできるような体制を整えておくといった取り組みが該当する。

# 1部 アーキテクトに必要な考え方
## アーキテクチャ思考とは
- アーキテクチャ思考とは以下の5つ要素で構成される

### 開発側との相互的な連携を行う
- 従来は問題領域に対応したシステムのアーキテクチャをアーキテクトが考え、実際のシステムの構築は開発側に委ねるような体制が一般的であったが、昨今ではそういったアーキテクトと開発側の壁は取り払い共同してシステムの開発に取り組むことが求められる。

### 技術的な深さではなく幅を広げることを意識する
- 問題領域に適したアーキテクチャを考案する場合には、多くの選択肢を提示できるアーキテクトである方が望ましい。したがって特定の技術に特化した知識を身につけるよりも様々な知識を知っている方がアーキテクトとしては重宝される。

### トレードオフを分析する
- 問題領域における特有の事情と採用する技術を考慮し、検討しているアーキテクチャのメリット・デメリットを考えて各アーキテクチャを評価することが必要。

### ビジネスドライバーを理解する
- ビジネスを成功させるために考慮すべき要素をアーキテクチャ特性に変換するスキルや、それを定期的に評価する方法を検討する必要がある。

### アーキテクティングとコーディングのバランスをとる
- 開発側との共同が必要となってくるために、アーキテクトにも現場感覚を持つことが重要となってくる。したがって概念実証や些細な改修や開発生産性向上のためのツールの導入、コードレビューなどを行うことで現場感を養うことが重要。


# 2部 アーキテクチャスタイル

## 基礎
### 分散型のデメリット
- パフォーマンス、スケーラビリティ、可用性は分散型の方が優れている
- ネットワークの信頼性や安全性に比例してサービスのクオリティが変化してしまうのが分散型のデメリット
- レイテンシに関しては分散型よりもローカル通信で完結するモノリシック型の方が小さくなる傾向がある
- 使用する帯域幅はモノリシックの方が小さい
- ログが分散しているため原因の特定が難しい
- トランザクションの管理が難しいのでデータの整合性や完全性を担保することが難しい

## 各種アーキテクチャ

### レイヤードアーキテクチャ
- 小規模でシンプルなアプリケーションを開発する際に適しているアーキテクチャ。ただだんだんシステムが複雑化してくると他のアーキテクチャに乗り換える必要がでてくる。
- モノリシックなアプリケーションであることやモジュール性の欠如が原因で弾力性とスケーラビリティは低い。
- パフォーマンスも開発側が工夫しなければ決して優れているとは言えない。
- モノリシックなアプリケーションから耐障害性も高いとは言えない。システムの一部でメモリ不足が発生した場合にシステム全体がダウンする。

### サービスベースアーキテクチャ

### イベント駆動アーキテクチャ

### マイクロサービスアーキテクチャ

## 適切なアーキテクチャの選定ができるためには